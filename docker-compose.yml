version: "3.8"

services:
    gateway:
      build:
        context: ./gateway
        target: dev      
      command: npm start
      ports:
        - 3000:3000
      depends_on:
        - db
      volumes:
        - ./gateway:/user/gateway
      links:
        - db

    api:
      build: 
         context: ./api
         target: dev
      command: npm start
      ports:
        - 3001:3001
      depends_on:
        - db
      volumes:
        - ./api:/user/api
      links:
        - db

    ws:
      build:
        context: ./ws
        target: dev
      command: npm start
      ports:
        - 3002:3002
    db:
      image: mongo
      restart: unless-stopped
      environment:
        - MONGO_INITDB_ROOT_USERNAME=root
        - MONGO_INITDB_ROOT_PASSWORD=root
      ports:
        - 27017:27017
      volumes:
        - db:/data/db
  
volumes:
  db: